{"version":3,"sources":["../../src/detect.ts"],"sourcesContent":["// Copyright Â© Aptos Foundation\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  Wallet,\n  WalletWithFeatures,\n  WalletsEventsListeners,\n  getWallets\n} from '@wallet-standard/core'\n\nimport { MinimallyRequiredFeatures } from './features'\nimport { AptosWallet } from './wallet'\n\n// These features are absolutely required for wallets to function in the Aptos ecosystem.\n// Eventually, as wallets have more consistent support of features, we may want to extend this list.\nconst REQUIRED_FEATURES: (keyof MinimallyRequiredFeatures)[] = [\n  'aptos:account',\n  'aptos:connect',\n  'aptos:disconnect',\n  'aptos:network',\n  'aptos:onAccountChange',\n  'aptos:onNetworkChange',\n  'aptos:signMessage',\n  'aptos:signTransaction'\n]\n\nexport function isWalletWithRequiredFeatureSet<AdditionalFeatures extends Wallet['features']>(\n  wallet: Wallet,\n  additionalFeatures: (keyof AdditionalFeatures)[] = []\n): wallet is WalletWithFeatures<MinimallyRequiredFeatures & AdditionalFeatures> {\n  return [...REQUIRED_FEATURES, ...additionalFeatures].every(\n    (feature) => feature in wallet.features\n  )\n}\n\n/**\n * Helper function to get only Aptos wallets\n * @returns Aptos compatible wallets and `on` event to listen to wallets register event\n */\nexport function getAptosWallets(): {\n  aptosWallets: AptosWallet[]\n  on: <E extends keyof WalletsEventsListeners>(\n    event: E,\n    listener: WalletsEventsListeners[E]\n  ) => () => void\n} {\n  const { get, on } = getWallets()\n\n  const wallets = get()\n\n  const aptosWallets: Wallet[] = []\n\n  wallets.map((wallet: Wallet) => {\n    const isAptos = isWalletWithRequiredFeatureSet(wallet)\n\n    if (isAptos) {\n      aptosWallets.push(wallet)\n    }\n  })\n\n  return { aptosWallets: aptosWallets as AptosWallet[], on }\n}\n"],"mappings":"AAGA,OAIE,cAAAA,MACK,wBAOP,IAAMC,EAAyD,CAC7D,gBACA,gBACA,mBACA,gBACA,wBACA,wBACA,oBACA,uBACF,EAEO,SAASC,EACdC,EACAC,EAAmD,CAAC,EAC0B,CAC9E,MAAO,CAAC,GAAGH,EAAmB,GAAGG,CAAkB,EAAE,MAClDC,GAAYA,KAAWF,EAAO,QACjC,CACF,CAMO,SAASG,GAMd,CACA,GAAM,CAAE,IAAAC,EAAK,GAAAC,CAAG,EAAIR,EAAW,EAEzBS,EAAUF,EAAI,EAEdG,EAAyB,CAAC,EAEhC,OAAAD,EAAQ,IAAKN,GAAmB,CACdD,EAA+BC,CAAM,GAGnDO,EAAa,KAAKP,CAAM,CAE5B,CAAC,EAEM,CAAE,aAAcO,EAA+B,GAAAF,CAAG,CAC3D","names":["getWallets","REQUIRED_FEATURES","isWalletWithRequiredFeatureSet","wallet","additionalFeatures","feature","getAptosWallets","get","on","wallets","aptosWallets"]}